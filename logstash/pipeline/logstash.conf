input {
  tcp { port => 5000 codec => json_lines }
}
filter {
  # Lift MDC correlationId (if present) to top-level for easy search
  if [mdc] and [mdc][correlationId] {
    mutate { add_field => { "correlationId" => "%{[mdc][correlationId]}" } }
  }
  # Tag the pipeline only (service now comes from app logs)
  mutate { add_field => { "pipeline" => "tx-apps" } }
}

output {
  elasticsearch { hosts => ["http://elasticsearch:9200"] index => "tx-logs-%{+YYYY.MM.dd}" }
  stdout { codec => rubydebug }
}
